# üìä –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º—ã –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞

> **–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ  
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-06  
> **–°–ø—Ä–∏–Ω—Ç:** Sprint 4 - Backtesting System

---

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Task 4.2: –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

#### 1. **–†–∞—Å—à–∏—Ä–µ–Ω BybitClient** (`src/bybit_client.py`)

–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

- **`get_historical_klines()`** - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π —Å Bybit API
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤: '1', '5', '15', '30', '60', '240', 'D', 'W'
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã start_time, end_time –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
  - –õ–∏–º–∏—Ç –¥–æ 1000 —Å–≤–µ—á–µ–π –∑–∞ –∑–∞–ø—Ä–æ—Å (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ API)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

- **`get_historical_klines_range()`** - —É–º–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–∏–æ–¥–æ–≤ >1000 —Å–≤–µ—á–µ–π
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
  - Rate limiting (–∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

- **`_interval_to_milliseconds()`** - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
from bybit_client import BybitClient
from datetime import datetime, timedelta

bybit = BybitClient()

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π BTC
end_date = datetime.now()
start_date = end_date - timedelta(days=7)

klines = bybit.get_historical_klines_range(
    symbol='BTCUSDT',
    interval='15',  # 15-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏
    start_date=start_date,
    end_date=end_date
)

print(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(klines)} —Å–≤–µ—á–µ–π")
# –ö–∞–∂–¥–∞—è —Å–≤–µ—á–∞: {'timestamp', 'open', 'high', 'low', 'close', 'volume', 'turnover', 'datetime'}
```

#### 2. **–†–∞—Å—à–∏—Ä–µ–Ω–∞ Database** (`src/database.py`)

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:

- **–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `historical_klines`**
  - –•—Ä–∞–Ω–∏—Ç OHLCV –¥–∞–Ω–Ω—ã–µ
  - –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ (symbol, interval, timestamp)
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL –∏ SQLite

- **–ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –∫–µ—à–µ–º:**
  - `save_historical_klines()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤–µ—á–µ–π –≤ –ë–î
  - `get_historical_klines_from_cache()` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫–µ—à–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
  - `check_cache_coverage()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥
  - `clear_historical_cache()` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```sql
idx_historical_klines_symbol
idx_historical_klines_interval
idx_historical_klines_timestamp
idx_historical_klines_symbol_interval_timestamp  -- —Å–æ—Å—Ç–∞–≤–Ω–æ–π
```

#### 3. **–°–æ–∑–¥–∞–Ω DataLoader** (`src/data_loader.py`)

–£–º–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞ –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º (–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
from data_loader import DataLoader
from datetime import datetime, timedelta

loader = DataLoader()

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å —É–º–Ω—ã–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
klines = loader.load_historical_data(
    symbol='BTCUSDT',
    interval='15',
    start_date=datetime.now() - timedelta(days=30),
    end_date=datetime.now(),
    use_cache=True  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
)

# 2. –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∞
all_data = loader.preload_data_for_backtest(
    symbols=['BTCUSDT', 'ETHUSDT', 'SOLUSDT'],
    interval='15',
    start_date=datetime.now() - timedelta(days=7),
    end_date=datetime.now()
)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {'BTCUSDT': [...], 'ETHUSDT': [...], 'SOLUSDT': [...]}

# 3. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –∫–µ—à–∞
loader.clear_old_cache(days=30)  # –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
```

**–£–º–Ω—ã–µ —Ñ–∏—á–∏:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏
   - –î–æ–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å–≤–µ—á–∏
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–∏–æ–¥–∞

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏**
   - –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å: –∑–∞–≥—Ä—É–∑–∫–∞ —Å API + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å: –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
   - –ß–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –¥–æ–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤

3. **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–≤–µ—á–µ–π
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

#### 4. **–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç** (`src/test_data_loader.py`)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
python src/test_data_loader.py
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å API
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫–µ—à–∞
- ‚úÖ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–µ—à–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –§–æ—Ä–º–∞—Ç —Å–≤–µ—á–∏ (OHLCV):
```python
{
    'timestamp': 1733500800000,           # Unix timestamp –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    'open': 43250.50,                      # –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
    'high': 43500.00,                      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    'low': 43100.00,                       # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    'close': 43420.75,                     # –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
    'volume': 152.345,                     # –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤
    'turnover': 6624567.89,                # –û–±–æ—Ä–æ—Ç –≤ USDT
    'datetime': '2025-12-06T12:00:00'      # ISO —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
}
```

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–∞–ª—å—à–µ

### Task 4.1: –°–æ–∑–¥–∞—Ç—å Backtester –∫–ª–∞—Å—Å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

#### –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `BacktestEngine` (`src/backtester.py`)

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `VirtualTradingBot` (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞!)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤–º–µ—Å—Ç–æ live
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
# –ó–∞–ø—É—Å–∫ –±—ç–∫—Ç–µ—Å—Ç–∞
results = engine.run_backtest(
    symbols=['BTCUSDT', 'ETHUSDT'],
    interval='15',
    start_date=datetime(...),
    end_date=datetime(...),
    initial_balance=10000.0
)

# –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ç–æ–¥—ã:
- _load_historical_data()      # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DataLoader
- _simulate_trading()           # –ü—Ä–æ–≥–æ–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ
- _create_timeline()            # –°–æ–∑–¥–∞–Ω–∏–µ timeline –∏–∑ timestamp
- _process_historical_candle()  # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–π —Å–≤–µ—á–∏
- _calculate_results()          # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
- _print_report()               # –í—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–∞
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
BacktestEngine (extends VirtualTradingBot)
    ‚îÇ
    ‚îú‚îÄ‚îÄ –ù–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å—é –ª–æ–≥–∏–∫—É —Ç–æ—Ä–≥–æ–≤–ª–∏:
    ‚îÇ   ‚îú‚îÄ‚îÄ _execute_virtual_buy/sell
    ‚îÇ   ‚îú‚îÄ‚îÄ _close_virtual_position
    ‚îÇ   ‚îú‚îÄ‚îÄ calculate_position_size
    ‚îÇ   ‚îú‚îÄ‚îÄ calculate_stop_loss_take_profit
    ‚îÇ   ‚îî‚îÄ‚îÄ _check_virtual_position_conditions
    ‚îÇ
    ‚îú‚îÄ‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
    ‚îÇ   ‚îú‚îÄ‚îÄ historical_data (Dict[symbol: List[candles]])
    ‚îÇ   ‚îú‚îÄ‚îÄ current_backtest_time (—Ç–µ–∫—É—â–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞)
    ‚îÇ   ‚îú‚îÄ‚îÄ timeline (–≤—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞)
    ‚îÇ   ‚îî‚îÄ‚îÄ backtest_results (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
    ‚îÇ
    ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
        ‚îú‚îÄ‚îÄ DataLoader (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö)
        ‚îú‚îÄ‚îÄ Database (–∫–µ—à + —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
        ‚îú‚îÄ‚îÄ DeepSeekClient (—Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã)
        ‚îî‚îÄ‚îÄ BybitClient (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ)
```

**–ü—Ä–æ—Ü–µ—Å—Å –±—ç–∫—Ç–µ—Å—Ç–∞:**

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Üí DataLoader –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é
2. **–°–æ–∑–¥–∞–Ω–∏–µ timeline** ‚Üí –í—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ timestamp
3. **–°–∏–º—É–ª—è—Ü–∏—è** ‚Üí –î–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –≤—Ä–µ–º–µ–Ω–∏:
   - –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ—á—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
   - –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã –ø–æ–∑–∏—Ü–∏–π
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å stop-loss/take-profit
   - –ü–æ–ª—É—á–∏—Ç—å —Å–∏–≥–Ω–∞–ª –æ—Ç AI
   - –û—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏–∏
4. **–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫** ‚Üí ROI, Win Rate, Max DD –∏ –¥—Ä.
5. **–û—Ç—á–µ—Ç** ‚Üí –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:** `src/test_backtest.py`

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Å—Ç–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∞
python src/test_backtest.py

# –í—ã–≤–æ–¥:
# üöÄ –ó–ê–ü–£–°–ö –ë–≠–ö–¢–ï–°–¢–ê
# üìä –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
# üéØ –°–∏–º—É–ª—è—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏...
# üìà –ü—Ä–æ–≥—Ä–µ—Å—Å: 100%
# ‚úÖ –ë—ç–∫—Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!
# üìä ROI: +12.5%
# üéØ Win Rate: 65.2%
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞:**

```python
{
    'initial_balance': 10000.0,
    'final_balance': 11250.0,
    'total_pnl': 1250.0,
    'roi_percent': 12.5,
    'total_trades': 42,
    'winning_trades': 28,
    'losing_trades': 14,
    'win_rate': 66.67,
    'highest_balance': 11500.0,
    'lowest_balance': 9800.0,
    'max_drawdown': 14.78,
    'sharpe_ratio': 0.0,  # TODO: —É–ª—É—á—à–∏—Ç—å
    'profit_factor': 2.0  # TODO: —É–ª—É—á—à–∏—Ç—å
}
```

---

## ‚úÖ Task 4.3: –°–∏–º—É–ª—è—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏ - –ó–ê–í–ï–†–®–ï–ù–û

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

#### 1. **–£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –±–∏—Ä–∂–∏** ‚úÖ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∏—Å—Å–∏–π Bybit:

- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ë–î:**
  - `maker_fee_percent`: 0.055% (Bybit maker fee)
  - `taker_fee_percent`: 0.06% (Bybit taker fee)
  - `use_fees_in_backtest`: –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–π

- **–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `virtual_positions`:**
  - `entry_fee` - –∫–æ–º–∏—Å—Å–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
  - `exit_fee` - –∫–æ–º–∏—Å—Å–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
  - `total_fees` - —Å—É–º–º–∞ –≤—Å–µ—Ö –∫–æ–º–∏—Å—Å–∏–π –ø–æ –ø–æ–∑–∏—Ü–∏–∏

- **–ú–µ—Ç–æ–¥—ã —Ä–∞—Å—á–µ—Ç–∞:**
  - `calculate_trading_fee()` - —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ —Å–¥–µ–ª–∫—É
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ maker/taker –∫–æ–º–∏—Å—Å–∏–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–π –∏–∑ PnL

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ü–æ–∑–∏—Ü–∏—è –Ω–∞ $1000
# –ö–æ–º–∏—Å—Å–∏—è –≤—Ö–æ–¥–∞: $1000 * 0.06% = $0.60
# –ö–æ–º–∏—Å—Å–∏—è –≤—ã—Ö–æ–¥–∞: $1000 * 0.06% = $0.60
# –ò—Ç–æ–≥–æ –∫–æ–º–∏—Å—Å–∏–π: $1.20
# PnL —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π = gross_pnl - $1.20
```

#### 2. **–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Slippage** ‚úÖ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã:

- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
  - `slippage_percent`: 0.05% (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä)
  - `use_slippage_in_backtest`: –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ slippage

- **–õ–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**
  - –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ (BUY): —Ü–µ–Ω–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ slippage%
  - –ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ (SELL): —Ü–µ–Ω–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ slippage%
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ, —Ç–∞–∫ –∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏

- **–ú–µ—Ç–æ–¥:** `apply_slippage(price, side)` –≤ `VirtualTradingBot`

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞: $43,000
# BUY —Å slippage 0.05%: $43,021.50 (–ø–æ–∫—É–ø–∞–µ–º –¥–æ—Ä–æ–∂–µ)
# SELL —Å slippage 0.05%: $42,978.50 (–ø—Ä–æ–¥–∞–µ–º –¥–µ—à–µ–≤–ª–µ)
```

#### 3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ç–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã** ‚úÖ

–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:

- `_execute_virtual_buy()` - —É—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –∏ slippage –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ long
- `_execute_virtual_sell()` - —É—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –∏ slippage –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ short
- `_close_virtual_position()` - —É—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –∏ slippage –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤:**
```
üéØ –ò—Å–ø–æ–ª–Ω—è–µ–º –í–ò–†–¢–£–ê–õ–¨–ù–´–ô BUY —Å–∏–≥–Ω–∞–ª –¥–ª—è BTCUSDT
   üí´ Slippage: +0.050% (—Ü–µ–Ω–∞: $43000.00 ‚Üí $43021.50)
   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—Ö–æ–¥–∞: $0.6000 (0.060%)
```

#### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚úÖ

–ú–µ—Ç–æ–¥ `get_virtual_trade_stats()` —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:

- `total_fees_paid` - –æ–±—â–∞—è —Å—É–º–º–∞ –∫–æ–º–∏—Å—Å–∏–π
- `total_entry_fees` - —Å—É–º–º–∞ –∫–æ–º–∏—Å—Å–∏–π –ø—Ä–∏ –≤—Ö–æ–¥–µ
- `total_exit_fees` - —Å—É–º–º–∞ –∫–æ–º–∏—Å—Å–∏–π –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
- `total_profit` - –æ–±—â–∞—è –ø—Ä–∏–±—ã–ª—å (–¥–ª—è Profit Factor)
- `total_loss` - –æ–±—â–∏–µ —É–±—ã—Ç–∫–∏ (–¥–ª—è Profit Factor)

#### 5. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚úÖ

- **Profit Factor:** —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã –ø—Ä–∏–±—ã–ª–∏ –∏ —É–±—ã—Ç–∫–æ–≤
- **–û—Ç—á–µ—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞:** –≤–∫–ª—é—á–∞—é—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–∏—Å—Å–∏—è—Ö
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å:** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–π

**–ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞:**
```
üí∏ –ö–æ–º–∏—Å—Å–∏–∏:
   –í—Å–µ–≥–æ –∫–æ–º–∏—Å—Å–∏–π: $12.4560
   –ö–æ–º–∏—Å—Å–∏–∏ –≤—Ö–æ–¥–∞: $6.2280
   –ö–æ–º–∏—Å—Å–∏–∏ –≤—ã—Ö–æ–¥–∞: $6.2280
   –í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å: 0.125%
```

#### 6. **–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç** ‚úÖ

–°–æ–∑–¥–∞–Ω `test_fees_slippage.py` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:
- –ò–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (–±–µ–∑ –∫–æ–º–∏—Å—Å–∏–π –∏ slippage)
- –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (—Å –∫–æ–º–∏—Å—Å–∏—è–º–∏ –∏ slippage)
- –†–∞—Å—á–µ—Ç –≤–ª–∏—è–Ω–∏—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ó–∞–ø—É—Å–∫:**
```bash
python src/test_fees_slippage.py
```

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

**–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ `entry_fee`, `exit_fee`, `total_fees`
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PostgreSQL –∏ SQLite
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±–∞–∑

**–§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞:**

```python
# –ö–æ–º–∏—Å—Å–∏—è
fee = position_value * (fee_percent / 100)

# Slippage
if side == 'BUY':
    price_with_slippage = price * (1 + slippage_percent / 100)
else:  # SELL
    price_with_slippage = price * (1 - slippage_percent / 100)

# PnL —Å –∫–æ–º–∏—Å—Å–∏—è–º–∏
pnl_net = pnl_gross - entry_fee - exit_fee
```

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

–ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ Bybit:

- **–ö–æ–º–∏—Å—Å–∏–∏:** —Å–Ω–∏–∂–∞—é—Ç ROI –Ω–∞ ~0.12-0.24% –∑–∞ —Å–¥–µ–ª–∫—É
- **Slippage:** —Å–Ω–∏–∂–∞–µ—Ç ROI –Ω–∞ ~0.05-0.10% –∑–∞ —Å–¥–µ–ª–∫—É  
- **–°—É–º–º–∞—Ä–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ:** ~0.17-0.34% –∑–∞ full round trip (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥)

–î–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å 50 —Å–¥–µ–ª–∫–∞–º–∏ –∑–∞ –º–µ—Å—è—Ü:
- –ü–æ—Ç–µ—Ä–∏ –æ—Ç –∫–æ–º–∏—Å—Å–∏–π: ~6-12% –≥–æ–¥–æ–≤—ã—Ö
- –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å!

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### Task 4.3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ (–∑–∞–¥–µ—Ä–∂–∫–∏, —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ)
- [ ] –£—á–µ—Ç –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
- [ ] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π slippage –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞

### Task 4.4: –ú–µ—Ç—Ä–∏–∫–∏ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- [x] ROI (Return on Investment) ‚úÖ
- [x] Win Rate ‚úÖ
- [x] Max Drawdown (–±–∞–∑–æ–≤—ã–π) ‚úÖ
- [ ] Sharpe Ratio (—É–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç)
- [ ] Profit Factor (—É–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç)
- [ ] Sortino Ratio
- [ ] Calmar Ratio
- [ ] Average Trade Duration
- [ ] Expectancy

### Task 4.5: Web UI
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ –±–∞–ª–∞–Ω—Å–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- [ ] Equity curve
- [ ] –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫
- [ ] Heatmap –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ HTML/PDF

---

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±—ç–∫—Ç–µ—Å—Ç–µ

### –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

```python
from data_loader import DataLoader
from datetime import datetime, timedelta

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
loader = DataLoader()

# –ü–µ—Ä–∏–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
start_date = datetime(2025, 11, 1)
end_date = datetime(2025, 12, 1)

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
symbols = ['BTCUSDT', 'ETHUSDT']
historical_data = loader.preload_data_for_backtest(
    symbols=symbols,
    interval='15',
    start_date=start_date,
    end_date=end_date
)

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –±—ç–∫—Ç–µ—Å—Ç
# for timestamp in timeline:
#     for symbol in symbols:
#         current_candle = get_candle_at_timestamp(historical_data[symbol], timestamp)
#         signal = strategy.get_signal(current_candle)
#         execute_trade(signal)
```

---

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ö–µ—à –≤ –ë–î ‚Üí –±—ã—Å—Ç—Ä—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏ –±—ç–∫—Ç–µ—Å—Ç–æ–≤
   - –ò–Ω–¥–µ–∫—Å—ã ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

2. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
   - Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã

3. **–£–¥–æ–±—Å—Ç–≤–æ**
   - –ü—Ä–æ—Å—Ç–æ–π API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

4. **–ì–∏–±–∫–æ—Å—Ç—å**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª—é–±—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
   - –†–∞–±–æ—Ç–∞ —Å PostgreSQL –∏ SQLite
   - –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Bybit API:
- –ú–∞–∫—Å–∏–º—É–º 1000 —Å–≤–µ—á–µ–π –∑–∞ –∑–∞–ø—Ä–æ—Å
- Rate limit: ~120 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- –†–µ—à–µ–Ω–æ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏

### –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î:
- PostgreSQL: DECIMAL –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- SQLite: REAL (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è)
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∫–ª—é—á (symbol, interval, timestamp)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ~1-2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É 1000 —Å–≤–µ—á–µ–π —Å API
- <100–º—Å –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ –∫–µ—à–∞ –ë–î
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π –≤ –∫–µ—à–µ

---

**–ê–≤—Ç–æ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** AI Assistant  
**–î–∞—Ç–∞:** 2025-12-06  
**–í–µ—Ä—Å–∏—è:** 0.1.0-alpha

